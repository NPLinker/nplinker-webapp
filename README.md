# NPLinker Web Application

[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.6875502.svg)](https://doi.org/10.5281/zenodo.6875502)

üëâ **[Webapp Live Demo](https://nplinker-webapp.onrender.com)**

The [NPLinker](https://nplinker.github.io/nplinker/latest/) web application, built with [Plotly Dash](https://dash.plotly.com/), provides an interactive interface for visualizing NPLinker predictions.

## Online Demo

A live demo of the NPLinker webapp is automatically deployed to [Render](https://render.com/) from `main` branch.
You can try out the webapp directly in your browser [here](https://nplinker-webapp.onrender.com).

### Getting Started with Demo Data

The webapp includes a convenient **"Load Demo Data"** button that automatically loads some sample data for you to try. Simply:

1. Open the [live demo link](https://nplinker-webapp.onrender.com/)
2. Click the **"Load Demo Data"** button below the file uploader
3. The app will automatically download and process the sample dataset from [`tests/data/mock_obj_data.pkl`](https://github.com/NPLinker/nplinker-webapp/blob/main/tests/data/mock_obj_data.pkl)
4. Start exploring natural product linking features!

This demo web server is intended only for lightweight demo purposes. For full functionality, including large-scale data processing and persistent storage, please install the application locally or via Docker as described below.

<details>
<summary>‚ö†Ô∏è Demo Server Limitations</summary>

<p>Please note the following limitations of the hosted demo:</p>

<ul>
  <li><strong>Cold start delay</strong>: Free-tier apps on Render sleep after 15 minutes of inactivity and may take 20‚Äì30 seconds to wake up.</li>
  <li><strong>Performance</strong>: This is a minimal deployment on a free tier and is not optimized for large datasets or concurrent users.</li>
  <li><strong>File size limits</strong>: The demo data button loads a small sample dataset suitable for testing. Uploading large datasets via the file uploader may lead to errors or timeouts.</li>
  <li><strong>No persistent storage</strong>: Uploaded files are not saved between sessions.</li>
</ul>

</details>

## Using the webapp

### Input Data

The webapp accepts data generated by NPLinker and saved as described in the [NPLinker quickstart section](https://nplinker.github.io/nplinker/latest/quickstart/). For testing purposes, a small sample dataset is provided in [`tests/data/mock_obj_data.pkl`](https://github.com/NPLinker/nplinker-webapp/blob/main/tests/data/mock_obj_data.pkl) that can be used to try out the webapp.

Please note that links between genomic and metabolomic data must currently be computed using the NPLinker API separately, as this functionality is not yet implemented in the webapp (see [issue #19](https://github.com/NPLinker/nplinker-webapp/issues/19)). If no links are present in your data, the scoring table will be disabled.

### Filtering Table Data

The "Candidate Links" tables support data filtering to help you focus on relevant results. You can enter filter criteria directly into each column‚Äôs filter cell by hovering over the cell.

For numeric columns like "Average Score" or "# Links":

- `34.6` or `= 34.6` (exact match)
- `> 30` (greater than)
- `<= 50` (less than or equal to)

For text columns like "BGC Classes" or "MiBIG IDs":

- `Polyketide` or `contains Polyketide` (contains text)
- `= Polyketide` (exact match)

Multiple filters can be applied simultaneously across different columns to narrow down results.

For a full list of supported filter operators, see the [official Plotly documentation](https://dash.plotly.com/datatable/filtering#filtering-operators).

## Installation

Before installing NPLinker webapp, ensure you have:

- [Python ‚â•3.10](https://www.python.org/downloads/)
- [Git](https://git-scm.com/downloads)
- [Conda](https://docs.conda.io/en/latest/miniconda.html)

You can install and run the NPLinker webapp in two ways: directly on your local machine or using Docker.

### Option 1: Local Installation (using Conda)

Follow these steps to install the application directly on your system:

1. **Clone the repository**
   ```bash
   git clone https://github.com/NPLinker/nplinker-webapp.git
   cd nplinker-webapp
   ```

2. **Set up a conda environment**
   ```bash
    # Create a new conda environment with Python 3.10
    conda create -n nplinker-webapp python=3.10

    # Activate the environment
    conda activate nplinker-webapp
   ```

3. **Install dependencies**
   ```bash
   pip install -e .
   ```

4. **Run the application**
   ```bash
   python app/main.py
   ```

5. **Access the webapp**
   
   Open your web browser and navigate to `http://0.0.0.0:8050/`

<details>
<summary>Troubleshooting Local Installation</summary>

<h4>Common issues and solutions</h4>

<ul>
  <li><strong>Port already in use</strong>: If port 8050 is already in use, modify the port in <code>app/main.py</code> by changing <code>app.run_server(debug=True, port=8050)</code></li>
  <li><strong>Package installation errors</strong>: Make sure you're using Python 3.10 and that your pip is up-to-date</li>
</ul>

<p>If you encounter other problems, please check the <a href="https://github.com/NPLinker/nplinker-webapp/issues">Issues</a> page or create a new issue.</p>

</details>

### Option 2: Docker Installation

Using Docker is the quickest way to get started with NPLinker webapp. Make sure you have [Docker](https://www.docker.com/) installed on your system before proceeding:

1. **Pull the Docker image**
   ```bash
   docker pull ghcr.io/nplinker/nplinker-webapp:latest
   ```

2. **Run the container**
   ```bash
   docker run -p 8050:8050 ghcr.io/nplinker/nplinker-webapp:latest
   ```

3. **Access the webapp**
   
   Open your web browser and navigate to `http://0.0.0.0:8050/`

<details>
<summary>Docker Image Information</summary>

<ul>
  <li><strong>Available Tags</strong>:
    <ul>
      <li><code>latest</code>: The most recent build</li>
      <li>Specific version tags based on GitHub releases</li>
    </ul>
  </li>

  <li><strong>Performance Note</strong>: The application running in Docker might be slower than running it directly on your machine, depending on your Docker resource allocation settings. If you experience performance issues, consider increasing Docker's CPU and memory limits in your Docker Desktop settings, or use the local installation method.</li>

  <li><strong>More Details</strong>: For additional information about the Docker image, see its <a href="https://github.com/NPLinker/nplinker-webapp/pkgs/container/nplinker-webapp">GitHub Container Registry page</a>.</li>
</ul>

</details>
